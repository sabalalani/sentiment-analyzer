<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Sentiment Analyzer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .sentiment-positive { border-left: 5px solid #28a745; background-color: #f8fff9; }
        .sentiment-negative { border-left: 5px solid #dc3545; background-color: #fff8f8; }
        .sentiment-neutral { border-left: 5px solid #ffc107; background-color: #fffef8; }
        .confidence-bar { height: 20px; background-color: #e9ecef; border-radius: 10px; overflow: hidden; }
        .confidence-fill { height: 100%; transition: width 0.5s ease; }
        .sentiment-icon { font-size: 3rem; margin-bottom: 1rem; }
    </style>
</head>
<body class="bg-light">
    <div class="container mt-5">
        <header class="text-center mb-4">
            <h1 class="display-4 text-primary">üß† AI Sentiment Analyzer</h1>
            <p class="lead">Analyze emotions and sentiments in text using advanced AI models</p>
        </header>

        <div class="row">
            <div class="col-md-7 mb-4">
                <div class="card shadow-sm">
                    <div class="card-header bg-white">
                        <h5 class="mb-0">Input Text</h5>
                    </div>
                    <div class="card-body">
                        <textarea id="text-input" class="form-control" rows="12" placeholder="Enter text to analyze sentiment (reviews, comments, tweets, etc.)..."></textarea>
                        <small class="text-muted" id="char-count">0/1000 characters</small>
                    </div>
                </div>
            </div>

            <div class="col-md-5">
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-white">
                        <h5 class="mb-0">Analysis Options</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="model-select" class="form-label">Select Model:</label>
                            <select class="form-select" id="model-select">
                                <option value="Roberta-Twitter" selected>Roberta-Twitter (Recommended)</option>
                                <option value="DistilBERT">DistilBERT (Fast)</option>
                            </select>
                            <small class="text-muted">Optimized for social media text and reviews</small>
                        </div>

                        <button class="btn btn-primary w-100 mt-3" id="analyze-btn" onclick="analyzeSentiment()">
                            <span class="spinner-border spinner-border-sm loading-spinner me-2" role="status" aria-hidden="true"></span>
                            Analyze Sentiment
                        </button>
                    </div>
                </div>

                <div class="card shadow-sm">
                    <div class="card-header bg-white">
                        <h5 class="mb-0">Sentiment Results</h5>
                    </div>
                    <div class="card-body">
                        <div id="sentiment-output" class="text-center">
                            <div class="sentiment-icon">üòä</div>
                            <p class="text-muted">Results will appear here after analysis</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-12">
                <div class="card shadow-sm">
                    <div class="card-header bg-white">
                        <h5 class="mb-0">üí° Example Texts to Try</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h6>Positive</h6>
                                        <p class="small">"I absolutely love this product! It has exceeded all my expectations and the quality is outstanding."</p>
                                        <button class="btn btn-outline-success btn-sm" onclick="loadExample(this)">Try This</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h6>Negative</h6>
                                        <p class="small">"This is the worst service I've ever experienced. The product broke immediately and customer support was terrible."</p>
                                        <button class="btn btn-outline-danger btn-sm" onclick="loadExample(this)">Try This</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h6>Neutral</h6>
                                        <p class="small">"The package arrived on time. The product seems to work as described in the specifications."</p>
                                        <button class="btn btn-outline-warning btn-sm" onclick="loadExample(this)">Try This</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const API_URL = '/analyze';

        // Character counter
        document.getElementById('text-input').addEventListener('input', function(e) {
            const count = e.target.value.length;
            document.getElementById('char-count').textContent = `${count}/1000 characters`;
        });

        function loadExample(button) {
            const text = button.parentElement.querySelector('p').textContent;
            document.getElementById('text-input').value = text;
            document.getElementById('char-count').textContent = `${text.length}/1000 characters`;
        }

        async function analyzeSentiment() {
            const inputText = document.getElementById('text-input').value;
            const modelName = document.getElementById('model-select').value;
            const outputDiv = document.getElementById('sentiment-output');
            const analyzeBtn = document.getElementById('analyze-btn');
            const loadingSpinner = document.querySelector('.loading-spinner');

            if (inputText.trim() === "") {
                outputDiv.innerHTML = '<div class="alert alert-warning">Please enter some text to analyze.</div>';
                return;
            }

            if (inputText.length > 1000) {
                outputDiv.innerHTML = '<div class="alert alert-danger">Text too long. Maximum 1000 characters.</div>';
                return;
            }

            // Show loading state
            analyzeBtn.disabled = true;
            loadingSpinner.style.display = 'inline-block';
            outputDiv.innerHTML = `
                <div class="text-center">
                    <div class="spinner-border text-primary mb-3" role="status"></div>
                    <p>Analyzing sentiment...</p>
                </div>
            `;

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        text: inputText,
                        model_name: modelName
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    displaySentimentResult(data);
                } else {
                    outputDiv.innerHTML = `<div class="alert alert-danger">Error: ${data.detail || 'Unknown error'}</div>`;
                }

            } catch (error) {
                console.error('Analysis error:', error);
                outputDiv.innerHTML = '<div class="alert alert-danger">Connection error. Please try again.</div>';
            } finally {
                analyzeBtn.disabled = false;
                loadingSpinner.style.display = 'none';
            }
        }

        function displaySentimentResult(data) {
            const outputDiv = document.getElementById('sentiment-output');
            const sentimentClass = `sentiment-${data.sentiment.toLowerCase()}`;
            const confidenceWidth = data.confidence + '%';

            let icon, color, bgColor;
            switch(data.sentiment.toLowerCase()) {
                case 'positive':
                    icon = 'üòä';
                    color = '#28a745';
                    break;
                case 'negative':
                    icon = 'üòû';
                    color = '#dc3545';
                    break;
                case 'neutral':
                    icon = 'üòê';
                    color = '#ffc107';
                    break;
                default:
                    icon = 'ü§î';
                    color = '#6c757d';
            }

            outputDiv.innerHTML = `
                <div class="${sentimentClass} p-4 rounded">
                    <div class="sentiment-icon">${icon}</div>
                    <h3 class="mb-3">${data.sentiment}</h3>

                    <div class="mb-4">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Confidence:</span>
                            <strong>${data.confidence}%</strong>
                        </div>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="width: ${confidenceWidth}; background-color: ${color};"></div>
                        </div>
                    </div>

                    <div class="small text-muted">
                        Model: ${document.getElementById('model-select').value}
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>